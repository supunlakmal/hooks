import{useState as r,useEffect as n,useLayoutEffect as t,useRef as o}from"react";import e from"media-typer";import i from"content-type";"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));export default function(u,a){var l=r({data:null,loading:0,error:null,controller:null}),c=l[0],s=l[1],f=o(!1);return t(function(){return f.current=!0,function(){f.current=!1}},[]),n(function(){var r=new AbortController;return u&&function(r,n,t,o){void 0===n&&(n={});try{var u=Object.assign({},n,{signal:t.signal}),a=null;Promise.resolve(function(n,l){try{var c=(o(function(r){return{data:null,loading:r.loading+1,error:null,controller:t}}),Promise.resolve(fetch(r,u)).then(function(r){function n(){if(!a.ok){var r=new Error(a.statusText);throw r.status=a.status,r}}var t=(a=r).headers.get("content-type"),u=function(){if(t){function r(){o(function(r){return Object.assign({},r,{data:n,loading:r.loading-1})})}var n=null,u=function(r){if(r){var n=i.parse(r),t=e.parse(n.type);if("json"===t.subtype)return!0;if("json"===t.suffix)return!0;if(t.suffix&&/\bjson\b/i.test(t.suffix))return!0;if(t.subtype&&/\bjson\b/i.test(t.subtype))return!0}return!1}(t)?Promise.resolve(a.json()).then(function(r){n=r}):Promise.resolve(a.text()).then(function(r){n=r});return u&&u.then?u.then(r):r()}o(function(r){return Object.assign({},r,{loading:r.loading-1})})}();return u&&u.then?u.then(n):n()}))}catch(r){return l(r)}return c&&c.then?c.then(void 0,l):c}(0,function(r){var n="AbortError"!==r.name?r:null;o(function(r){return Object.assign({},r,{error:n,loading:a?r.loading:r.loading-1})})}))}catch(r){return Promise.reject(r)}}(u,a,r,function(r){f.current&&s(r)}),function(){return r.abort()}},[a,u]),{data:c.data,loading:!!c.loading,error:c.error,abort:function(){return c.controller&&c.controller.abort()}}}
//# sourceMappingURL=index.mjs.map
